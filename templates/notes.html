{% extends "base.html" %}

{% block title %}My Notes{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h3 mb-1">My notes</h1>
    <p class="text-muted mb-0">Create, open, edit, delete.</p>
  </div>

  <a href="{{ url_for('notes.dashboard') }}" class="btn btn-outline-light">
    Back to dashboard
  </a>
</div>

<form method="get" class="d-flex gap-2 mb-3">
  <input
    type="text"
    name="q"
    value="{{ q or '' }}"
    class="form-control"
    placeholder="Search notes"
  >
  <button type="submit" class="btn">Search</button>

  {% if q %}
    <a href="{{ url_for('notes.notes') }}" class="btn btn-outline-light">Clear</a>
  {% endif %}
</form>

<div class="row g-3">
  <div class="col-12 col-lg-5">
    <div class="card p-4">
      <h2 class="h5 mb-3">Create note</h2>

      <form method="POST" action="{{ url_for('notes.notes') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div class="mb-3">
          <label class="form-label" for="title">Title</label>
          <input
            id="title"
            type="text"
            name="title"
            class="form-control"
            placeholder="Note title"
            required
          >
        </div>

        <div class="mb-3">
          <label class="form-label" for="content">Content</label>
          <textarea
            id="content"
            name="content"
            class="form-control"
            placeholder="Note content"
            rows="8"
            required
          ></textarea>
        </div>

        <button type="submit" class="btn btn-primary w-100">
          Create note
        </button>
      </form>
    </div>
  </div>

  <div class="col-12 col-lg-7">
    <div class="card p-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="h5 mb-0">Your notes</h2>
        <span class="text-muted small">{{ notes|length }} total</span>
      </div>

      {% if notes|length == 0 %}
        <div class="text-center py-4">
          <div class="h6 mb-1">No notes yet</div>
          <div class="text-muted">Create one using the form.</div>
        </div>
      {% else %}
        <div class="list-group">
          {% for note in notes %}
            <div class="list-group-item bg-transparent border-0 px-0 py-3">
              <div class="d-flex justify-content-between align-items-start">
                <div class="me-3">
                  <div class="fw-semibold">{{ note.title }}</div>
                  <div class="text-muted small">{{ note.created_at }}</div>
                </div>

                <div class="d-flex flex-wrap gap-2 justify-content-end">
                  <a class="btn btn-sm btn-outline-light"
                     href="{{ url_for('notes.view_note', note_id=note.id) }}">
                    Open
                  </a>

                  <a class="btn btn-sm btn-outline-light"
                     href="{{ url_for('notes.edit_note', note_id=note.id) }}">
                    Edit
                  </a>

                  <form method="POST"
                        action="{{ url_for('notes.delete_note', note_id=note.id) }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-sm btn-outline-danger">
                      Delete
                    </button>
                  </form>
                </div>
              </div>

              {% if not loop.last %}
              <hr class="my-3" style="border-color: rgba(255,255,255,.08);">
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}
